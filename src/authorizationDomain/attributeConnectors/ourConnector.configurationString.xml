<configuration xmlns="http://www.axiomatics.com/attributeconnector/parser/json/configuration"
               identifier="ourConnector">
    <source>
        <json>
            {
                "users": {
                    "martin": {
                        "role": "manager",
                        "location": "stockholm"
                    },
                    "cecilia": {
                        "role": "consultant",
                        "location": "london"
                    }
                },
                "resources": {
                    "2": {
                        "location": "stockholm"
                    },
                    "1": {
                        "location": "london"
                    }
                }
            }
        </json>
    </source>

    <mapping>
        <xacmlAttribute AttributeId="user.role"
                        Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                        DataType="http://www.w3.org/2001/XMLSchema#string"/>
        <jsonPath>$.users['##1##'].role</jsonPath>
        <key>
            <xacmlAttribute AttributeId="user.identity"
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                            DataType="http://www.w3.org/2001/XMLSchema#string"/>
        </key>
    </mapping>

    <mapping>
        <xacmlAttribute AttributeId="user.location"
                        Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                        DataType="http://www.w3.org/2001/XMLSchema#string"/>
        <jsonPath>$.users['##1##'].location</jsonPath>
        <key>
            <xacmlAttribute AttributeId="user.identity"
                            Category="urn:oasis:names:tc:xacml:1.0:subject-category:access-subject"
                            DataType="http://www.w3.org/2001/XMLSchema#string"/>
        </key>
    </mapping>

    <mapping>
        <xacmlAttribute AttributeId="resource.location"
                        Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                        DataType="http://www.w3.org/2001/XMLSchema#string"/>
        <jsonPath>$.resources['##1##'].location</jsonPath>
        <key>
            <xacmlAttribute AttributeId="resource.identity"
                            Category="urn:oasis:names:tc:xacml:3.0:attribute-category:resource"
                            DataType="http://www.w3.org/2001/XMLSchema#string"/>
        </key>
    </mapping>

</configuration>
